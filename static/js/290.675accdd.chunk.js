"use strict";(self.webpackChunk_example_website=self.webpackChunk_example_website||[]).push([[290],{1253:function(t,n,e){e.r(n),e.d(n,{AuthButton:function(){return l},AuthorizedBtn:function(){return l},AuthorizedConfigProvider:function(){return d},default:function(){return _},getAuthButton:function(){return p},getAuthorizedPage:function(){return i},useAuthorizedonfig:function(){return s}});var r=e(7896),u=e(56976),o=e(29855),i=function(t,n){if(ANTD_AUTH_CONF){var e=sessionStorage.getItem(ANTD_AUTH_CONF.auth_menu)?JSON.parse(sessionStorage.getItem(ANTD_AUTH_CONF.auth_menu)||"[]"):[],r=a(t,n).length>0,u=function(t,n){var e=!0;return-1===(ANTD_AUTH_CONF.auth_check_url?n.findIndex((function(n){return n[ANTD_AUTH_CONF.auth_check_url]===t})):n.findIndex((function(n){return n===t})))&&(e=!1),"/404"!==t&&"/403"!==t&&"/"!==t&&"/welcome"!==t||(e=!0),e}(n,e);return r&&!u?403:!(!r||!u)||404}return!0},a=function t(n,e,r){return void 0===r&&(r=[]),(n||[]).forEach((function(n){var u=n.path,o=n.routes;u==e||"/404"===u||"/403"===u||"/"===u||"/welcome"===u?r.push(n):o&&t(o,e,r)})),r},h=e(14218),c=(0,u.createContext)({auth_menu:"authMenu",auth_btn:"authBtn",auth_check_url:"menuUrl",isCheckAuth:!1}),d=function(t){var n=t.children,e=t.auth_menu,r=void 0===e?"authMenu":e,u=t.auth_btn,o=void 0===u?"authBtn":u,i=t.auth_check_url,a=void 0===i?"menuUrl":i,d=t.isCheckAuth,s=void 0!==d&&d;return(0,h.jsx)(c.Provider,{value:{auth_menu:r,auth_btn:o,auth_check_url:a,isCheckAuth:s},children:n})},s=function(){return(0,u.useContext)(c)},l=function(t){var n=t.path,e=t.children,r=s(),o=r.auth_btn,i=r.auth_check_url,a=r.isCheckAuth,c=(0,u.useMemo)((function(){var t=sessionStorage.getItem(o||"");return t?JSON.parse(t):[]}),[JSON.stringify({auth_btn:o,auth_check_url:i})]),d=(0,u.useMemo)((function(){return!a||(i?!!c.find((function(t){return t[i]===n})):!!c.find((function(t){return t===n})))}),[c,n,a]);return n&&a&&!d?(0,h.jsx)(u.Fragment,{}):(0,h.jsx)(u.Fragment,{children:e})},p=function(t,n){void 0===n&&(n={});var e=n||{},r=e.auth_btn,u=e.auth_check_url,o=function(){var t=r;t||(t="boolean"===typeof ANTD_AUTH_CONF?"":ANTD_AUTH_CONF.auth_btn);var n=sessionStorage.getItem(t||"");return n?JSON.parse(n):[]};return function(){var n=u||"";return n||(n="boolean"===typeof ANTD_AUTH_CONF?"":ANTD_AUTH_CONF.auth_check_url),n?!!o().find((function(e){return e[n]===t})):!!o().find((function(n){return n===t}))}()},_=function(t){return t.authority?(0,h.jsx)(u.Fragment,{children:u.Children.map(t.children,(function(t){return u.isValidElement(t)?u.cloneElement(t,(0,r.Z)({},t.props)):t}))}):(0,u.useMemo)((function(){return t.redirectPath?(0,h.jsx)(o.Fg,{to:t.redirectPath,replace:!0}):(0,h.jsx)(u.Fragment,{children:t.children})}),[t.redirectPath])}},73290:function(t,n,e){e.r(n),n.default={components:{114:function(){var t,n=(t=e(56976))&&t.__esModule?t:{default:t},r=e(1253);sessionStorage.setItem("auth_btn",JSON.stringify(["/api/select"]));return function(){return n.default.createElement(r.AuthorizedConfigProvider,{isCheckAuth:!0},n.default.createElement(r.AuthorizedBtn,{path:"/api/select"},n.default.createElement("button",null,"\u67e5\u8be2")),n.default.createElement(r.AuthorizedBtn,{path:"/api/select2"},n.default.createElement("button",null,"\u67e5\u8be22")))}}()},data:{114:{name:114,meta:{},code:'"use strict";\n\nvar _react = _interopRequireDefault(require("react"));\nvar _authorized = require("@antdp/authorized");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }\n// \u4e3a\u4e86\u6e32\u67d3\u8bbe\u7f6e\u7684\u672c\u5730\u6743\u9650\u6570\u636e\nsessionStorage.setItem("auth_btn", JSON.stringify(["/api/select"]));\nvar Demo = function Demo() {\n  return /*#__PURE__*/_react["default"].createElement(_authorized.AuthorizedConfigProvider, {\n    isCheckAuth: true\n  }, /*#__PURE__*/_react["default"].createElement(_authorized.AuthorizedBtn, {\n    path: "/api/select"\n  }, /*#__PURE__*/_react["default"].createElement("button", null, "\\u67E5\\u8BE2")), /*#__PURE__*/_react["default"].createElement(_authorized.AuthorizedBtn, {\n    path: "/api/select2"\n  }, /*#__PURE__*/_react["default"].createElement("button", null, "\\u67E5\\u8BE22")));\n};\nreturn Demo;',language:"tsx",value:'// \u4e3a\u4e86\u6e32\u67d3\u8bbe\u7f6e\u7684\u672c\u5730\u6743\u9650\u6570\u636e\nsessionStorage.setItem("auth_btn",JSON.stringify(["/api/select"]))\n\nimport React from "react"\nimport { AuthorizedBtn ,AuthorizedConfigProvider } from "@antdp/authorized"\n\nconst Demo = ()=>{\n  return (<AuthorizedConfigProvider isCheckAuth={true} >\n    <AuthorizedBtn path="/api/select" >\n      <button>\u67e5\u8be2</button>\n    </AuthorizedBtn>\n    <AuthorizedBtn path="/api/select2" >\n      <button>\u67e5\u8be22</button>\n    </AuthorizedBtn>\n  </AuthorizedConfigProvider>)\n}\nexport default Demo;\n'}},source:'@antdp/authorized\n---\n\n[![npm](https://img.shields.io/npm/v/@antdp/authorized.svg?maxAge=3600)](https://www.npmjs.com/package/@antdp/authorized)\n[![npm download](https://img.shields.io/npm/dm/@antdp/authorized.svg?style=flat)](https://www.npmjs.com/package/@antdp/authorized)\n\n\u6743\u9650\u5224\u65ad\u7ec4\u4ef6\u6216\u65b9\u6cd5\uff0c\u901a\u8fc7\u5224\u65ad\u662f\u5426\u8fdb\u5165\u4e3b\u754c\u9762\u8fd8\u662f\u767b\u5f55\u754c\u9762\u3002\n\n## Installation\n\n```bash\n$ npm i @antdp/authorized  # yarn add @antdp/authorized\n```\n## \u53c2\u6570\n\n```ts\ninterface AuthorizedProps {\n  /**\n   * \u51c6\u5165\u6743\u9650/\u6743\u9650\u5224\u65ad\n   */\n  authority?: boolean;\n  /**\n   * \u6743\u9650\u5f02\u5e38\u65f6\u91cd\u5b9a\u5411\u7684\u9875\u9762\u8def\u7531\n   */\n  redirectPath?: string;\n  children?: React.ReactNode;\n}\n/**\n * @description: \u9875\u9762\u6743\u9650\n * @param {Array} menuRouter \u539f\u59cb routes.json \u6587\u4ef6\u4e2d\u8def\u7531\n * @param {string} path \u5f53\u524d\u8def\u5f84\n * @return {*}\n */\ntype GetAuthorizedPageProps = (menuRouter: Array<any>, path: string) => boolean | 404 | 403\n// \u6309\u94ae\u6743\u9650\ninterface AuthorizedBtnProps {\n  // \u6743\u9650\u8def\u5f84\n  path?: string,\n  // \u5c55\u793a\u5185\u5bb9\n  children?: React.ReactNode\n}\n```\n\n## AuthorizedConfigProvider \u8bbe\u7f6e\u6309\u94ae\u6743\u9650\u914d\u7f6e\n\n\u4f7f\u7528 `AuthorizedConfigProvider`\u53ef\u4ee5\u81ea\u5df1\u8fdb\u884c\u91cd\u65b0\u8bbe\u7f6e\u7ec4\u4ef6\u5305\u88f9\u5185\u7684\u6240\u6709\u6309\u94ae\u7684\u6743\u9650\u53c2\u6570\uff0c\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u7684\u6309\u94ae\u6743\u9650\u914d\u7f6e\n\n```ts\nexport interface AuthorizedConfigProviderProps {\n  auth_menu?: string,\n  auth_btn?: string,\n  auth_check_url?: string,\n  isCheckAuth?: boolean\n  children?: React.ReactNode\n}\n\n```\n\n## useAuthorizedonfig \u83b7\u53d6\u5f53\u524d\u7ec4\u4ef6\u8303\u56f4\u5185\u7684\u6743\u9650\u914d\u7f6e\u53c2\u6570\n\n```ts\n// \u8fd4\u56de\u53c2\u6570\n{\n  /** \u5b58\u50a8\u672c\u5730\u83dc\u5355  key */\n  auth_menu?: string;\n  /** \u5b58\u50a8\u672c\u5730\u6309\u94ae  key */\n  auth_btn?: string;\n  /** \u6821\u9a8c \u5b57\u6bb5  undefined \u65f6 \u6743\u9650\u6570\u636e\u4e3a  string[] ,\u5426\u5219\u4e3a { auth_check_url:string}[] */\n  auth_check_url?: string | undefined;\n  /**\u662f\u5426\u8fdb\u884c\u6743\u9650\u9a8c\u8bc1*/\n  isCheckAuth?: boolean\n}\n\n```\n\n## \u5224\u65ad\u83dc\u5355\u662f\u5426\u6709\u6743\u9650\n\n```ts\nimport { getAuthorizedPage } from \'@antdp/authorized\';\n\nconst isCheckMenu = getAuthorizedPage([{path:"/web"},{path:"/examples"}],"/examples")\n\n```\n\n## \u9875\u9762\u6743\u9650\u5224\u65ad\u91cd\u5b9a\u5411\n\n```jsx\nimport React from \'react\';\nimport BasicLayout from \'@antdp/basic-layouts\';\nimport UserLogin from \'@antdp/user-login\';\nimport Authorized from \'@antdp/authorized\';\n\n// \u5165\u53e3\u9875\u9762\nconst UserLayout = (props) => {\n  return (\n    <Authorized authority={!props.token} redirectPath="/login">\n      <UserLogin />\n    </Authorized>\n  )\n};\n\n// \u767b\u5f55\u9875\u9762\nconst Layout = (props) => {\n  return (\n    <Authorized authority={!props.token} redirectPath="/">\n      <BasicLayout />\n    </Authorized>\n  )\n};\n```\n\n## \u6309\u94ae\u6743\u9650\n\n```tsx mdx:preview\n// \u4e3a\u4e86\u6e32\u67d3\u8bbe\u7f6e\u7684\u672c\u5730\u6743\u9650\u6570\u636e\nsessionStorage.setItem("auth_btn",JSON.stringify(["/api/select"]))\n\nimport React from "react"\nimport { AuthorizedBtn ,AuthorizedConfigProvider } from "@antdp/authorized"\n\nconst Demo = ()=>{\n  return (<AuthorizedConfigProvider isCheckAuth={true} >\n    <AuthorizedBtn path="/api/select" >\n      <button>\u67e5\u8be2</button>\n    </AuthorizedBtn>\n    <AuthorizedBtn path="/api/select2" >\n      <button>\u67e5\u8be22</button>\n    </AuthorizedBtn>\n  </AuthorizedConfigProvider>)\n}\nexport default Demo;\n\n```\n'}}}]);
//# sourceMappingURL=290.675accdd.chunk.js.map