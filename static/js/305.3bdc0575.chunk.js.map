{"version":3,"file":"static/js/305.3bdc0575.chunk.js","mappings":"iIACA,WACIA,WAAY,CAAG,EACfC,KAAM,CAAC,EACPC,OAAQ,8iQ","sources":["pages/update/README.md"],"sourcesContent":["\nexport default {\n    components: {  },\n    data: {},\n    source: \"从 v1 到 v2\\n===\\n\\n### 升级准备\\n- 1.请先升级到 1.x 的最新版本。\\n\\n\\n### 技术调整\\n- 1.[antd 从 v4 到 v5](https://ant.design/docs/react/migration-v5-cn)\\n- 2.[umi  从 v3 到 v4](https://ant.design/docs/react/migration-v5-cn)\\n- 3.`basic-layouts` 重构，并添加 `useLayouts` 的hooks [`2b3ad38`](https://github.com/antdpro/antdp/commit/2b3ad38deca0b31b9f575980bf1239249ae738b5)\\n- 4.`Authorized` 添加 `AuthorizedConfigProvider和useAuthorizedonfig` [`cf75f09`](https://github.com/antdpro/antdp/commit/cf75f096ad0646a1e831f45141cc7c84c1442c2d)\\n- 5.`react` 升级至 `18.x`\\n\\n### 修复功能\\n- 🐞 fix:修复文档和权限取值判断 [`978d203`](https://github.com/antdpro/antdp/commit/978d2038c395d0252bb4409973703d776c10213c)\\n- 🐞 fix:修复预览标签 [`5968554`](https://github.com/antdpro/antdp/commit/5968554197f09bd5d8b1f75331f2102bf38e4ec2)\\n- 🐞 fix:修复 umi setup [`a128746`](https://github.com/antdpro/antdp/commit/a128746362ad5804d0e94c9e9be0daff1a1b5cf3)\\n- 🐞 fix:修复案例包版本 [`f45300b`](https://github.com/antdpro/antdp/commit/f45300b90841b2435745c9a3460fd74c2131383b)\\n- 🆎 type:修复类型 [`29eeb92`](https://github.com/antdpro/antdp/commit/29eeb926c64a1958d7e8723462b75d28bddb1c90)\\n- 🐞 fix:修复表单设置初始隐藏表单项 [`86ac78f`](https://github.com/antdpro/antdp/commit/86ac78f4af5c7409c981501f633b60989d5c97b0)\\n- 🐞 fix:修复本地文档预览网站 [`869d72b`](https://github.com/antdpro/antdp/commit/869d72bc69132fd5b4f2faa4044ffd923e8f16ce)\\n- 🆎 type:修复类型 [`2b68319`](https://github.com/antdpro/antdp/commit/2b683192c1f3af1fed393c6329e8789ad09b986a)\\n- 🐞 fix:修复菜单隐藏问题 [`9bc0070`](https://github.com/antdpro/antdp/commit/9bc00702e76eb8548dc7f0f9022afffa804f85cf)\\n- 💄 chore:修复website依赖问题 [`7ce8e30`](https://github.com/antdpro/antdp/commit/7ce8e301a0880b36d9ef923f3c4e4477663dafe7)\\n- 💄 chore:修复依赖 [`a17a49a`](https://github.com/antdpro/antdp/commit/a17a49acae6e63cf38a0c8fb8941b8cb902652b9)\\n- 🐞 fix:修复渲染判断 [`c5e96df`](https://github.com/antdpro/antdp/commit/c5e96df0d50922ce08beef55844a0efe76735bbc)\\n- 🐞 fix:修复命令运行 [`8083747`](https://github.com/antdpro/antdp/commit/80837475fd9b8aa177d53a99ef8b41cc12b93273)\\n- 🐞 fix:修复全屏按钮 [`4f0c851`](https://github.com/antdpro/antdp/commit/4f0c8515a5467e776bc243b33f8ac67fec6c5523)\\n\\n### 开始升级\\n\\n#### 依赖层升级\\n```diff\\n  \\\"dependencies\\\": {\\n     ...\\n-    \\\"@antdp/antdp-ui\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/authorized\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/basic-layouts\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/edit-table\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/hooks\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/page-loading\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/request\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/user-login\\\": \\\"1.8.27\\\",\\n-    \\\"ahooks\\\": \\\"~3.3.0\\\",\\n-    \\\"antd\\\": \\\"4.24.1\\\",\\n-    \\\"react\\\": \\\"17.0.2\\\",\\n-    \\\"react-dom\\\": \\\"17.0.2\\\"\\n+    \\\"@antdp/antdp-ui\\\": \\\"2.0.0\\\",\\n+    \\\"@antdp/authorized\\\": \\\"1.8.27\\\",\\n+    \\\"@antdp/basic-layouts\\\": \\\"1.8.27\\\",\\n+    \\\"@antdp/edit-table\\\": \\\"1.8.27\\\",\\n+    \\\"@antdp/hooks\\\": \\\"1.8.27\\\",\\n+    \\\"@antdp/page-loading\\\": \\\"1.8.27\\\",\\n+    \\\"@antdp/request\\\": \\\"1.8.27\\\",\\n+    \\\"@antdp/user-login\\\": \\\"1.8.27\\\",\\n+    \\\"ahooks\\\": \\\"~3.7.2\\\",\\n+    \\\"antd\\\": \\\"5.4.2\\\",\\n+    \\\"react\\\": \\\"18.2.0\\\",\\n+    \\\"react-dom\\\": \\\"18.2.0\\\"\\n     ...\\n  }\\n```\\n\\n```diff\\n  \\\"devDependencies\\\": {\\n-    \\\"@antdp/config\\\": \\\"1.8.27\\\",\\n-    \\\"@antdp/dependencies\\\": \\\"1.8.27\\\",\\n-    \\\"@umijs/plugin-dva\\\": \\\"0.13.2\\\",\\n-    \\\"@umijs/plugin-locale\\\": \\\"0.16.0\\\",\\n-    \\\"@umijs/plugin-model\\\": \\\"2.6.2\\\",\\n-    \\\"@umijs/plugin-request\\\": \\\"2.9.0\\\",\\n-    \\\"@umijs/test\\\": \\\"3.5.20\\\",\\n-    \\\"lint-staged\\\": \\\"~12.3.7\\\",\\n-    \\\"prettier\\\": \\\"2.4.1\\\",\\n-    \\\"react-sortable-hoc\\\": \\\"2.0.0\\\",\\n-    \\\"umi\\\": \\\"~3.5.35\\\"\\n+    \\\"@antdp/config\\\": \\\"2.0.0-bate-4.1\\\",\\n+    \\\"@antdp/dependencies\\\": \\\"2.0.0-bate-4.1\\\",\\n+    \\\"@umijs/max\\\": \\\"~4.0.47\\\",\\n+    \\\"@umijs/plugin-model\\\": \\\"~2.6.2\\\",\\n+    \\\"lint-staged\\\": \\\"~13.0.4\\\",\\n+    \\\"prettier\\\": \\\"2.8.1\\\"\\n  }\\n```\\n\\n#### 代码层修改\\n\\nUmi 4 中将 react-router@5 升级到 react-router@6，所以路由相关的一些 api 存在着使用上的差异。\\n\\nprops 默认为空对象，以下属性都不能直接从 props 中取出\\n![](./images/O1CN01H9ScQv21ymaLkwZ8p_!!6000000007054-2-tps-1210-374.png)<!--rehype:style=max-width: 650px;width: 100%;-->\\n\\n#### AuthorizedConfigProvider\\n使用 `AuthorizedConfigProvider`可以自己进行重新设置组件包裹内的所有按钮的权限参数，不使用默认配置的按钮权限配置\\n```diff\\n  sessionStorage.setItem(\\\"authBtn\\\",JSON.stringify([{menuUrl:\\\"/api/select\\\"}]))\\n\\n  import React from \\\"react\\\"\\n+ import { AuthorizedBtn ,AuthorizedConfigProvider } from \\\"@antdp/authorized\\\"\\n\\n  const Page = ()=>{\\n    return (\\n+      <AuthorizedConfigProvider isCheckAuth={true} >\\n        <AuthorizedBtn path=\\\"/api/select\\\" >\\n          <button>查询</button>\\n        </AuthorizedBtn>\\n+      </AuthorizedConfigProvider>\\n  )\\n}\\nexport default Page;\\n```\\n\\n\\n#### history\\n```diff\\n+ import { history } from '@umijs/max';\\nexport default function Page(props) {\\n  return (\\n    <div onClick={()=>{\\n-     props.history.push('list');\\n+     history.push('list');\\n    }}>\\n    </div>\\n  );\\n} \\n```\\n#### location\\n```diff\\n+ import { useLocation } from '@umijs/max';\\nexport default function Page(props) {\\n+    let location = useLocation();\\n  return (\\n    <div>\\n-     { props.location }\\n+     { location }\\n    </div>\\n  );\\n}\\n```\\n\\n#### match\\n```diff\\n+ import { useMatch } from '@umijs/max';\\nexport default function Page(props) {\\n+ const match = useMatch({ path: 'list/search/:type' });\\n  return (\\n    <div>\\n-     { props.match }\\n+     { match }\\n    </div>\\n  );\\n}\\n```\\n在 class component 组件中的使用方式:\\n```diff\\n+import { matchPath } from '@umijs/max';\\nclass Page extends Component {\\n+  match = matchPath({ path: 'list/search/:type' }, window.location.pathname);\\n  state = {}\\n  render() {\\n    return (\\n      <div>\\n-        {this.props.match.type}\\n+        {this.match.type} \\n      </div>\\n    )\\n  }\\n}\\n```\\n#### SelectLang 和 useIntl\\n```diff\\n+ import { SelectLang,useIntl } from '@umijs/max';\\nimport BasicLayout from '@antdp/basic-layouts';\\nexport default function Page(props) {\\n+ const match = useMatch({ path: 'list/search/:type' });\\n  return (\\n    <BasicLayout\\n+      topRightLanguage={<SelectLang />}\\n+      intlLanguage={useIntl()}\\n    />\\n  );\\n}\\n```\\n\\n#### useModel\\n\\n```diff\\n+ import { useModel } from '@umijs/max';\\nexport default function Page(props) {\\n+ const { token } = useModel('user', (model) => ({ ...model }));\\n  return (\\n    <div>{token}</div>\\n  );\\n}\\n```\\n\\n更多 `Umi` 相关 [`api`](https://umijs.org/docs/api/api)\\n需要注意 match 数据的差异：\\n```bash\\n// match v5\\nisExact: true\\nparams: {}\\npath: \\\"/users/abc\\\"\\nurl: \\\"/users/abc\\\"\\n\\n// match v6\\nparams:{  }\\npathname: \\\"/list/search/articles\\\"\\npathnameBase: \\\"/list/search/articles\\\"\\npattern: {path: 'list/search/:type'}\\n```\\n更多改动和 api 变更，请查阅[`react-router@6`](https://reactrouter.com/en/6.10.0)\\n\\n#### location 中的 query 找不到？\\n```diff\\n- const { query } = history.location;\\n+ import { parse } from 'query-string';\\n+ const query = parse(history.location.search);\\n```\"\n  }"],"names":["components","data","source"],"sourceRoot":""}