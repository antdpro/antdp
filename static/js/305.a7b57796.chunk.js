"use strict";(self.webpackChunk_example_website=self.webpackChunk_example_website||[]).push([[305],{75305:function(n,t,a){a.r(t),t.default={components:{},data:{},source:'\u4ece v1 \u5230 v2\n===\n\n### \u5347\u7ea7\u51c6\u5907\n- 1.\u8bf7\u5148\u5347\u7ea7\u5230 1.x \u7684\u6700\u65b0\u7248\u672c\u3002\n\n\n### \u6280\u672f\u8c03\u6574\n- 1.[antd \u4ece v4 \u5230 v5](https://ant.design/docs/react/migration-v5-cn)\n- 2.[umi  \u4ece v3 \u5230 v4](https://umijs.org/docs/introduce/upgrade-to-umi-4)\n- 3.`basic-layouts` \u91cd\u6784\uff0c\u5e76\u6dfb\u52a0 `useLayouts` \u7684hooks [`2b3ad38`](https://github.com/antdpro/antdp/commit/2b3ad38deca0b31b9f575980bf1239249ae738b5)\n- 4.`Authorized` \u6dfb\u52a0 `AuthorizedConfigProvider\u548cuseAuthorizedonfig` [`cf75f09`](https://github.com/antdpro/antdp/commit/cf75f096ad0646a1e831f45141cc7c84c1442c2d)\n- 5.`react` \u5347\u7ea7\u81f3 `18.x`\n\n### \u4fee\u590d\u529f\u80fd\n- \ud83d\udc1e fix:\u4fee\u590d\u6587\u6863\u548c\u6743\u9650\u53d6\u503c\u5224\u65ad [`978d203`](https://github.com/antdpro/antdp/commit/978d2038c395d0252bb4409973703d776c10213c)\n- \ud83d\udc1e fix:\u4fee\u590d\u9884\u89c8\u6807\u7b7e [`5968554`](https://github.com/antdpro/antdp/commit/5968554197f09bd5d8b1f75331f2102bf38e4ec2)\n- \ud83d\udc1e fix:\u4fee\u590d umi setup [`a128746`](https://github.com/antdpro/antdp/commit/a128746362ad5804d0e94c9e9be0daff1a1b5cf3)\n- \ud83d\udc1e fix:\u4fee\u590d\u6848\u4f8b\u5305\u7248\u672c [`f45300b`](https://github.com/antdpro/antdp/commit/f45300b90841b2435745c9a3460fd74c2131383b)\n- \ud83c\udd8e type:\u4fee\u590d\u7c7b\u578b [`29eeb92`](https://github.com/antdpro/antdp/commit/29eeb926c64a1958d7e8723462b75d28bddb1c90)\n- \ud83d\udc1e fix:\u4fee\u590d\u8868\u5355\u8bbe\u7f6e\u521d\u59cb\u9690\u85cf\u8868\u5355\u9879 [`86ac78f`](https://github.com/antdpro/antdp/commit/86ac78f4af5c7409c981501f633b60989d5c97b0)\n- \ud83d\udc1e fix:\u4fee\u590d\u672c\u5730\u6587\u6863\u9884\u89c8\u7f51\u7ad9 [`869d72b`](https://github.com/antdpro/antdp/commit/869d72bc69132fd5b4f2faa4044ffd923e8f16ce)\n- \ud83c\udd8e type:\u4fee\u590d\u7c7b\u578b [`2b68319`](https://github.com/antdpro/antdp/commit/2b683192c1f3af1fed393c6329e8789ad09b986a)\n- \ud83d\udc1e fix:\u4fee\u590d\u83dc\u5355\u9690\u85cf\u95ee\u9898 [`9bc0070`](https://github.com/antdpro/antdp/commit/9bc00702e76eb8548dc7f0f9022afffa804f85cf)\n- \ud83d\udc84 chore:\u4fee\u590dwebsite\u4f9d\u8d56\u95ee\u9898 [`7ce8e30`](https://github.com/antdpro/antdp/commit/7ce8e301a0880b36d9ef923f3c4e4477663dafe7)\n- \ud83d\udc84 chore:\u4fee\u590d\u4f9d\u8d56 [`a17a49a`](https://github.com/antdpro/antdp/commit/a17a49acae6e63cf38a0c8fb8941b8cb902652b9)\n- \ud83d\udc1e fix:\u4fee\u590d\u6e32\u67d3\u5224\u65ad [`c5e96df`](https://github.com/antdpro/antdp/commit/c5e96df0d50922ce08beef55844a0efe76735bbc)\n- \ud83d\udc1e fix:\u4fee\u590d\u547d\u4ee4\u8fd0\u884c [`8083747`](https://github.com/antdpro/antdp/commit/80837475fd9b8aa177d53a99ef8b41cc12b93273)\n- \ud83d\udc1e fix:\u4fee\u590d\u5168\u5c4f\u6309\u94ae [`4f0c851`](https://github.com/antdpro/antdp/commit/4f0c8515a5467e776bc243b33f8ac67fec6c5523)\n\n### \u5f00\u59cb\u5347\u7ea7\n\n#### \u4f9d\u8d56\u5c42\u5347\u7ea7\n```diff\n  "dependencies": {\n     ...\n-    "@antdp/antdp-ui": "1.8.27",\n-    "@antdp/authorized": "1.8.27",\n-    "@antdp/basic-layouts": "1.8.27",\n-    "@antdp/edit-table": "1.8.27",\n-    "@antdp/hooks": "1.8.27",\n-    "@antdp/page-loading": "1.8.27",\n-    "@antdp/request": "1.8.27",\n-    "@antdp/user-login": "1.8.27",\n-    "ahooks": "~3.3.0",\n-    "antd": "4.24.1",\n-    "react": "17.0.2",\n-    "react-dom": "17.0.2"\n+    "@antdp/antdp-ui": "2.0.0",\n+    "@antdp/authorized": "1.8.27",\n+    "@antdp/basic-layouts": "1.8.27",\n+    "@antdp/edit-table": "1.8.27",\n+    "@antdp/hooks": "1.8.27",\n+    "@antdp/page-loading": "1.8.27",\n+    "@antdp/request": "1.8.27",\n+    "@antdp/user-login": "1.8.27",\n+    "ahooks": "~3.7.2",\n+    "antd": "5.4.2",\n+    "react": "18.2.0",\n+    "react-dom": "18.2.0"\n     ...\n  }\n```\n\n```diff\n  "devDependencies": {\n-    "@antdp/config": "1.8.27",\n-    "@antdp/dependencies": "1.8.27",\n-    "@umijs/plugin-dva": "0.13.2",\n-    "@umijs/plugin-locale": "0.16.0",\n-    "@umijs/plugin-model": "2.6.2",\n-    "@umijs/plugin-request": "2.9.0",\n-    "@umijs/test": "3.5.20",\n-    "lint-staged": "~12.3.7",\n-    "prettier": "2.4.1",\n-    "react-sortable-hoc": "2.0.0",\n-    "umi": "~3.5.35"\n+    "@antdp/config": "2.0.0-bate-4.1",\n+    "@antdp/dependencies": "2.0.0-bate-4.1",\n+    "@umijs/max": "~4.0.47",\n+    "@umijs/plugin-model": "~2.6.2",\n+    "lint-staged": "~13.0.4",\n+    "prettier": "2.8.1"\n  }\n```\n\n#### \u4ee3\u7801\u5c42\u4fee\u6539\n\nUmi 4 \u4e2d\u5c06 react-router@5 \u5347\u7ea7\u5230 react-router@6\uff0c\u6240\u4ee5\u8def\u7531\u76f8\u5173\u7684\u4e00\u4e9b api \u5b58\u5728\u7740\u4f7f\u7528\u4e0a\u7684\u5dee\u5f02\u3002`props` \u9ed8\u8ba4\u4e3a\u7a7a\u5bf9\u8c61\uff0c\u5c5e\u6027\u90fd\u4e0d\u80fd\u76f4\u63a5\u4ece props \u4e2d\u53d6\u51fa\n\n#### AuthorizedConfigProvider\n\u4f7f\u7528 `AuthorizedConfigProvider`\u53ef\u4ee5\u81ea\u5df1\u8fdb\u884c\u91cd\u65b0\u8bbe\u7f6e\u7ec4\u4ef6\u5305\u88f9\u5185\u7684\u6240\u6709\u6309\u94ae\u7684\u6743\u9650\u53c2\u6570\uff0c\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u7684\u6309\u94ae\u6743\u9650\u914d\u7f6e\n```diff\n  sessionStorage.setItem("authBtn",JSON.stringify([{menuUrl:"/api/select"}]))\n\n  import React from "react"\n+ import { AuthorizedBtn ,AuthorizedConfigProvider } from "@antdp/authorized"\n\n  const Page = ()=>{\n    return (\n+      <AuthorizedConfigProvider isCheckAuth={true} >\n        <AuthorizedBtn path="/api/select" >\n          <button>\u67e5\u8be2</button>\n        </AuthorizedBtn>\n+      </AuthorizedConfigProvider>\n  )\n}\nexport default Page;\n```\n\n\n#### history\n```diff\n+ import { history } from \'@umijs/max\';\nexport default function Page(props) {\n  return (\n    <div onClick={()=>{\n-     props.history.push(\'list\');\n+     history.push(\'list\');\n    }}>\n    </div>\n  );\n} \n```\n#### location\n```diff\n+ import { useLocation } from \'@umijs/max\';\nexport default function Page(props) {\n+    let location = useLocation();\n  return (\n    <div>\n-     { props.location }\n+     { location }\n    </div>\n  );\n}\n```\n\n#### match\n```diff\n+ import { useMatch } from \'@umijs/max\';\nexport default function Page(props) {\n+ const match = useMatch({ path: \'list/search/:type\' });\n  return (\n    <div>\n-     { props.match }\n+     { match }\n    </div>\n  );\n}\n```\n\u5728 class component \u7ec4\u4ef6\u4e2d\u7684\u4f7f\u7528\u65b9\u5f0f:\n```diff\n+import { matchPath } from \'@umijs/max\';\nclass Page extends Component {\n+  match = matchPath({ path: \'list/search/:type\' }, window.location.pathname);\n  state = {}\n  render() {\n    return (\n      <div>\n-        {this.props.match.type}\n+        {this.match.type} \n      </div>\n    )\n  }\n}\n```\n#### SelectLang \u548c useIntl\n```diff\n+ import { SelectLang,useIntl } from \'@umijs/max\';\nimport BasicLayout from \'@antdp/basic-layouts\';\nexport default function Page(props) {\n+ const match = useMatch({ path: \'list/search/:type\' });\n  return (\n    <BasicLayout\n+      topRightLanguage={<SelectLang />}\n+      intlLanguage={useIntl()}\n    />\n  );\n}\n```\n\n#### useModel\n\n```diff\n+ import { useModel } from \'@umijs/max\';\nexport default function Page(props) {\n+ const { token } = useModel(\'user\', (model) => ({ ...model }));\n  return (\n    <div>{token}</div>\n  );\n}\n```\n\n\u66f4\u591a `Umi` \u76f8\u5173 [`api`](https://umijs.org/docs/api/api)\n\u9700\u8981\u6ce8\u610f match \u6570\u636e\u7684\u5dee\u5f02\uff1a\n```bash\n// match v5\nisExact: true\nparams: {}\npath: "/users/abc"\nurl: "/users/abc"\n\n// match v6\nparams:{  }\npathname: "/list/search/articles"\npathnameBase: "/list/search/articles"\npattern: {path: \'list/search/:type\'}\n```\n\u66f4\u591a\u6539\u52a8\u548c api \u53d8\u66f4\uff0c\u8bf7\u67e5\u9605[`react-router@6`](https://reactrouter.com/en/6.10.0)\n\n#### location \u4e2d\u7684 query \u627e\u4e0d\u5230\uff1f\n```diff\n- const { query } = history.location;\n+ import { parse } from \'query-string\';\n+ const query = parse(history.location.search);\n```'}}}]);
//# sourceMappingURL=305.a7b57796.chunk.js.map